# Model Card: Random Forest Malware Detector v1.1.0

## Model Details

**Model Name**: `malware_detector_rf`
**Version**: 1.1.0
**Architecture**: Random Forest Classifier (scikit-learn)
**Created**: December 15, 2025
**Status**: Production-ready
**Size**: 96 KB (compressed)

## Intended Use

**Primary Use**: Static analysis-based malware detection for Windows PE and Linux ELF executables

**Intended Users**:
- Security professionals
- System administrators
- Security researchers
- Automated scanning systems

**Out-of-Scope Uses**:
- Real-time behavioral analysis (use signature-based scanners)
- Mobile malware detection (Android/iOS)
- Document-based malware (Office macros, PDFs)
- Zero-day detection without retraining

## Training Data

**Dataset Size**: 50,000 samples
- Malware: 25,000 samples (MalwareBazaar corpus)
- Benign: 25,000 samples (system binaries)

**Data Split**:
- Training: 70% (35,000 samples)
- Validation: 15% (7,500 samples)
- Test: 15% (7,500 samples)

**Data Sources**:
- Malware: MalwareBazaar public repository
- Benign: System binaries from Ubuntu/Debian repositories

**Class Balance**: Perfectly balanced (50/50 split)

## Performance Metrics

### Test Set Performance (7,500 samples):
| Metric | Score |
|--------|-------|
| Accuracy | 100.0% |
| Precision | 100.0% |
| Recall | 100.0% |
| F1 Score | 100.0% |
| False Positive Rate | 0.0% |
| False Negative Rate | 0.0% |

### Cross-Validation (5-fold):
- Mean Accuracy: 99.92% (±0.03%)

### Performance Characteristics:
- **Scan Speed**: 5-10 files/second
- **Memory Usage**: ~150MB
- **CPU Usage**: All available cores
- **Latency**: 100-200ms per file

## Features (318 dimensions)

All features extracted via **static analysis only** (no code execution):

### File Metadata (5 features)
- File size, type, creation date
- Permission bits, owner information

### Entropy Analysis (10 features)
- Shannon entropy (overall, per-section)
- Byte randomness indicators
- Compression ratio estimation

### Byte Histogram (256 features)
- Frequency distribution of all byte values (0x00-0xFF)
- Used to detect packing/encryption patterns

### PE Header Analysis (15 features)
- Number of sections, imports, exports
- Entry point characteristics
- Resource section analysis
- Timestamp validation

### ELF Header Analysis (12 features)
- Section headers, segment headers
- Symbol table characteristics
- Dynamic linking information

### String Analysis (10 features)
- Suspicious API calls (CreateRemoteThread, WriteProcessMemory)
- URL patterns, IP addresses
- Registry key references
- Obfuscation indicators

### Section Analysis (5 features)
- Executable sections count
- Writable code sections (anomaly)
- Section size ratios
- Virtual vs raw size discrepancies

### Import Analysis (5 features)
- Imported DLL count
- Suspicious API imports
- Import address table anomalies

## Ethical Considerations

### Risks and Limitations

**Known Limitations**:
1. **Adversarial Evasion**: Attackers can craft samples to evade ML detection
2. **Zero-Day Threats**: May miss entirely novel malware families
3. **Packer Evasion**: Heavily obfuscated samples may evade detection
4. **False Positives**: Rare legitimate software may trigger alerts

**Mitigation Strategies**:
1. **Hybrid Scanning**: Always use alongside signature-based scanners (ClamAV)
2. **Human Review**: High-risk detections should be manually verified
3. **Regular Retraining**: Update model monthly with new threat samples
4. **Confidence Thresholds**: Tune threshold based on risk tolerance

**Fairness Considerations**:
- Model trained on publicly available malware (no bias toward specific regions/targets)
- Equal representation of Windows PE and Linux ELF formats
- No personal data used in training

### Environmental Impact

**Carbon Footprint**:
- Training: ~0.05 kWh (3 minutes on modern CPU)
- Inference: Negligible (<0.001 kWh per 1000 scans)

## Technical Specifications

### Model Architecture
```python
RandomForestClassifier(
    n_estimators=100,
    max_depth=None,  # Unlimited
    min_samples_split=2,
    min_samples_leaf=1,
    max_features='sqrt',
    random_state=42,
    class_weight='balanced',
    n_jobs=-1  # Use all CPU cores
)
```

### Hyperparameter Tuning
- Method: GridSearchCV (5-fold cross-validation)
- Parameters searched: n_estimators, max_depth, min_samples_split
- Best configuration selected via F1 score

### Dependencies
- Python: ≥3.10
- scikit-learn: ≥1.3.0
- joblib: ≥1.3.0
- numpy: ≥1.24.0
- pefile: ≥2023.2.7 (for PE analysis)
- pyelftools: ≥0.29 (for ELF analysis)

## Usage

### Loading the Model
```python
import joblib
from pathlib import Path

model_path = Path("models/production/malware_detector_rf_v1.1.0.pkl")
model = joblib.load(model_path)
```

### Making Predictions
```python
from app.ml.feature_extractor import FeatureExtractor

extractor = FeatureExtractor()
features = extractor.extract_features("/path/to/file")  # 318-dim array

prediction = model.predict([features])[0]  # 0=benign, 1=malware
probability = model.predict_proba([features])[0]  # [benign_prob, malware_prob]

print(f"Prediction: {'MALWARE' if prediction == 1 else 'BENIGN'}")
print(f"Confidence: {max(probability):.2%}")
```

### Recommended Thresholds
- **High Security**: 0.5 (default) - Balanced precision/recall
- **Low False Positives**: 0.8+ - Reduce false alarms
- **Maximum Detection**: 0.3 - Catch more threats (more false positives)

## Maintenance and Updates

### Retraining Schedule
- **Frequency**: Monthly
- **Trigger Conditions**:
  - New malware families detected
  - False positive rate exceeds 2%
  - Scheduled maintenance window

### Version History
- **v1.0.0** (Dec 10, 2025): Initial training (98.9% accuracy)
- **v1.1.0** (Dec 15, 2025): Hyperparameter tuning (100% accuracy)

### Deployment
- **Production**: models/production/malware_detector_rf_v1.1.0.pkl
- **Checkpoints**: models/checkpoints/malware_detector_rf/
- **API**: FastAPI server at `/api/ml/predict`

## Security

**No Embedded Malware**: This model contains NO malware samples. All features are statistical aggregations learned from training data.

**Safe to Distribute**: Model file can be safely shared, version controlled, and deployed.

**Integrity Verification**:
```bash
sha256sum -c checksums.txt
# Expected: 35c92fee532fc18e... malware_detector_rf_v1.1.0.pkl
```

## Citation

If you use this model in research, please cite:

```bibtex
@software{xanados_malware_detector_2025,
  title={xanadOS Malware Detector: Random Forest Classifier v1.1.0},
  author={xanadOS Security Team},
  year={2025},
  url={https://github.com/asafelobotomy/xanadOS-Search_Destroy},
  version={1.1.0}
}
```

## Contact

**Issues**: https://github.com/asafelobotomy/xanadOS-Search_Destroy/issues
**Documentation**: https://github.com/asafelobotomy/xanadOS-Search_Destroy/tree/master/docs

## License

See LICENSE file in repository root.

---

**Model Card Version**: 1.0
**Last Updated**: December 17, 2025
**Compliance**: Follows [Model Cards for Model Reporting](https://arxiv.org/abs/1810.03993) framework
