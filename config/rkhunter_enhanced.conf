# Enhanced RKHunter Configuration - False Positive Reduction
# Generated: September 5, 2025
# Purpose: Reduce false positives while maintaining security detection

# Copy the base configuration and add these improvements
cp /home/vm/.config/search-and-destroy/rkhunter.conf /home/vm/.config/search-and-destroy/rkhunter.conf.backup

# Whitelist known false positive hidden files
ALLOWHIDDENDIR="/usr/share/man/man5"
ALLOWHIDDENFILE="/usr/share/man/man5/.k5identity.5.gz"
ALLOWHIDDENFILE="/usr/share/man/man5/.k5login.5.gz"

# Disable tests that generate too many false positives on modern systems
DISABLE_TESTS="suspscan hidden_procs deleted_files packet_cap_apps"

# Enable more accurate detection methods
SCANROOTKITMODE=1
UNHIDE_TESTS=1

# Skip checks that are prone to false positives
SKIP_KEYPRESS=1
AUTO_X_DETECT=1

# Update database hash checking
HASH_CMD=sha256sum
PKGMGR_NO_VRFY=""

# Network interface monitoring (reduce false positives)
IFACE="eth0"

# Log configuration
LOGFILE=/tmp/rkhunter-scan.log
APPEND_LOG=1
COPY_LOG_ON_ERROR=1
